---
title: "Practical Machine Learning Course Project"
author: "Kevin Spring"
date: "09/15/2014"
output: html_document
---

# Background

Using devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. These type of devices are part of the quantified self movement â€“ a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. In this project, your goal will be to use data from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. They were asked to perform barbell lifts correctly and incorrectly in 5 different ways. More information is available from the website here: http://groupware.les.inf.puc-rio.br/har (see the section on the Weight Lifting Exercise Dataset).

# Question

What exercise routine is the person doing?

# Input Data 

The training data for this project are available here: 

https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv

The test data are available here: 

https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv

## Load the data

```{r}
testing <- read.csv("data/pml-testing.csv")
training <- read.csv("data/pml-training.csv")
```

## Info on the data
- Classe: 5 exercise routines
- 6 participants
- The purpose is to predict what exercise someone is doing from specific measurements of their body


## clean up the data
```{r}

# Remove any nonquantitative variables
trainingSub <- training[-c(1:7)]
trainingSubQuant <- trainingSub[, sapply(trainingSub, is.numeric)]

## Add back the Classe variable
trainingSubQuant$classe <- training$classe

# Data cleanup

## Remove all columsn that are only NA values
# trainingSubQuant <- trainingSubQuant[ , !apply( trainingSubQuant , 2 , function(x) all(is.na(x)) ) ]
trainingSubQuant <- trainingSubQuant[,! colSums(is.na(trainingSubQuant)) >= 19216]
```


# Cross Validation

```{r}
library(caret)
library(C50)
library(irr)

folds <- createFolds(y=trainingSubQuant$classe,
                       k = 10,
                       list=T,
                       returnTrain=T)

# The following function divides the trainingSubQuant data set into traiing and test data, creates a decision tree using the C5.0() function on the training data, generates a set of predictions from the test data, and compares teh predicted and actual values using the kappa2() function.

cv_results <- lapply(folds, function(x) {
  train <- trainingSubQuant[x, ]
  test <- trainingSubQuant[-x, ]
  #model <- C5.0(classe ~ ., data= train)
  model <- randomForest(classe ~ ., data=train, ntree=50)
  pred <- predict(model, test)
  actual <- test$classe
  kappa <- kappa2(data.frame(actual, pred))$value
  return(kappa)
})

```

## Random forests

```{r}
inTrain <- createDataPartition(y=trainingSubQuant$classe,
                               p=0.75,
                               list=F)

trainingSet <- trainingSubQuant[inTrain,]
testingSet <- trainingSubQuant[-inTrain,]

# Random forest
m <- randomForest(classe ~ ., data=trainingSet, ntree=300)

p <- predict(m, testingSet)
```


## Predict for each test set

```{r}
# Remove any nonquantitative variables
testingSub <- testing[-c(1:7)]
testingSubQuant <- testingSub[, sapply(testingSub, is.numeric)]

## Add back the Classe variable
testingSubQuant$classe <- testing$classe

# Data cleanup

## Remove all columsn that are only NA values
testingSubQuant <- testingSubQuant[,! colSums(is.na(testingSubQuant)) >= 19216]

pred <- as.character(predict(m, testingSubQuant))

```



## How did you cross validate?

# Algorithm

# Parameters

# Evaluation


## What do you think the expected out of sample error is

## Why did you make any choices